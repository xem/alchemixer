<meta charset=utf-8>

<style>
* { margin: 0; padding: 0; border: 0; box-sizing: border-box; outline: 0; }
body { background: radial-gradient(#def 50%, #abc) fixed; text-align: center; font-family: Arial; height: 100%; }
#elements { padding: 20px 0 0 180px; }
#elements a, #tube a { position: relative; transition: all .75s; top: 0; -moz-user-select: none; user-select: none; color: #222; text-decoration: none; cursor: move; width: 100px; height: 100px; padding: 10px 5px 0; margin: 5px; border-radius: 50%; background: #fff; border: 3px solid #d00; display: inline-block; vertical-align: top; box-shadow: 5px 5px 5px #555; }
#tube a { top: -100px }
h1 { font-size: 30px; margin: 15px 0; line-height: 10px; letter-spacing: -5px; text-indent: -5px; }
h2 { font-size: 40px; font-family: Trebuchet MS; margin: 10px 0; }
h3 { font-size: 14px; margin: 10px 0; }
p { font-size: 14px; line-height: 16px }
#tube { overflow: visible; box-shadow: 5px 5px 5px #888; position: fixed; top: 50%; display: block; float: left; margin: -150px 0 0 20px; width: 150px; height: 300px; background: none repeat-y right bottom #eef; border: 5px solid #456; border-top: 5px solid #456; background-image: linear-gradient(-20deg, transparent 5%, #456 5%, #456 25%, transparent 25%); background-size: 10px 20px; border-radius: 50% / 10px 10px 20px 20px; }
#tube:before { z-index: 2; content: ""; width: 150px; height: 100px; display: block; border: 5px solid transparent; border-bottom: 5px solid #456; border-radius: 0 0 50% 50% / 0 0 15px 15px; position: fixed; left: 15px; top: 50%; margin-top: -240px; }
#tube.x1 { padding-top: 150px; transition: all .5s }
#tube.x1 a, #tube.x2 a:last-child { top: 0; }
#tube.mixed { padding-top: 150px; }
#tube.x2 { padding-top: 40px }
#tube.x2.mix a:first-child, #tube.x2.nomix a:first-child { position: relative; top: 110px; }
#tube.x2.mix a, #elements a.mix { background: #fff; color: #fff; border-color: #fff; box-shadow: 0px 0px 20px #fff; }
#tube.x2.nomix a { background: #000; color: #000; border-color: #000; box-shadow: 0px 0px 20px #000; }
#tube.x2.poof a { opacity: 0 }
#elements a.combined { position: fixed; top: 50%; left: 40px }
#buttons { padding: 20px; background: rgba(0,0,0,0.8); position: fixed; bottom: 0; width: 100%; }
button { cursor: pointer; border: 3px solid #48c; background: #ddd; font-size: 16px; line-height: 16px; padding: 5px 10px; border-radius: 5px; }
input { border: 3px solid #48c; background: #ddd; font-size: 16px; line-height: 16px; padding: 5px 10px; border-radius: 5px; }
#elements a.end { transition: none }
aside { position: fixed; top: -100px; left: 50%; opacity: 0; margin-left: -175px; z-index: 99; margin-top: -100px; transform: scale(.1); transition: all .5s; background: #def; border: 3px solid #48c; border-radius: 20px; width: 400px; padding: 20px; }
aside.visible { top: 50%; opacity: 1; transform: scale(1.5); box-shadow: 0 0 0 9999px rgba(0,0,0,0.3) }
.hidden { display: none!important; opacity: 0; transform:scale(2) } </style>

<aside id=dialog_browser>
<b>Welcome to AlcheMixer!</b>
<br>
Sorry, you must use Firefox or IE to play this game in good conditions!
<br>
<br>
<button onclick=dialog_browser.className=''>OK!</button>
</aside>

<aside id=dialog_start>
<b>Welcome to AlcheMixer!</b>
<br>
Drag & drop two elements in the test tube to create a new one!
<br>
<button onclick=dialog_start.className=''>OK!</button>
</aside>

<aside id=dialog_save>
<b>You found a new element!</b>
<br>
The first of a long list.
<br>
To help you in your quest, you'll find a search engine and a save / load button on the bottom.
<br>
<button onclick="dialog_save.className=''; buttons.className = ''; search.className = ''; ">OK!</button>
</aside>

<aside id=dialog_hint>
<b>Congrats! You found 10 elements!</b>
<br>
You now have access to a "Hint" button!
<br>
<br>
<button onclick=dialog_hint.className='';hint.style.display="">OK!</button>
</aside>

<aside id=dialog_human>
<b>Whoa! You found 30 elements!</b>
<br>
Let's add the fifth element: the Human!
<br>
<br>
<button onclick=dialog_human.className='';Human.className=''>OK!</button>
</aside>

<div id=tube>

</div>

<div id=elements>
<h2>AlcheMixer</h2>
<h3><span id=score>0</span> / 500 elements found</h3>
<a ondragstart="event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)" href="javascript:;" draggable="true" class=hidden id="Human"><h1>ğŸ‘«</h1><p>Human</p></a><a id=Earth draggable=true href=javascript:; ondragstart="event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)"><h1>â™</h1><p>Earth</p></a><a id=Water draggable=true href=javascript:; ondragstart="event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)"><h1>ğŸ’§</h1><p>Water</p></a><a id=Air draggable=true href=javascript:; ondragstart="event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)"><h1>â‰ˆ</h1><p>Air</p></a><a id=Fire draggable=true href=javascript:; ondragstart="event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)"><h1>ğŸ”¥</h1><p>Fire</p></a>
</div>

<br>
<br>
<br>

<div id=buttons class=hidden>
<input id=search placeholder=search class=hidden>
<button id=hint class=hidden onclick="this.innerHTML = show_hint()">Hint!</button>
<button id=save class=hidden onclick="localStorage['alchemixer'] = elements.innerHTML; className = 'hidden'">Save</button>
<button id=load class=hidden onclick="elements.innerHTML = localStorage['alchemixer']; className = 'hidden'; search.className = ''; if(+score.innerHTML >= 10) hint.className = ''; if(+score.innerHTML >= 30) Human.className = 'visible'; search.focus();">Load</button>
<button onclick="window.open('http://twitter.com/home?status=' + encodeURIComponent('I found ' + score.innerHTML + ' elements in #AlcheMixer!\nGive it a try on js13kgames.com.\n#js13k .@MaximeEuziere\n' + window.location))">ğŸ¦</button>
</div>
<br>
<br>
<br>
<script>

// Load
onload=function(){

  // Dialog intro
  if(navigator.userAgent.indexOf("Chrome") > -1 || navigator.userAgent.indexOf("Opera") > -1 || navigator.userAgent.indexOf("Chrome") > -1){
    setTimeout("dialog_browser.className = 'visible'", 1000);
  }
  else{
    if(!localStorage["alchemixer_start"]){
      setTimeout("dialog_start.className = 'visible'", 1000);
      localStorage["alchemixer_start"] = 1;
    }
  }

  // Save/load
  if(localStorage["alchemixer"]){
    buttons.className="";
    load.className="";
  }
  
  search.focus();
}

// Search
search.value='';
search.onkeyup=function(e){
  els = document.querySelectorAll("#elements a");
  if(search.value){
    for(i=0;i<els.length;i++){
      if(els[i].id.toLowerCase().indexOf(search.value.toLowerCase().replace(/ /g,"")) == -1){
        els[i].style.display="none";
      }
      else{
        els[i].style.display="inline-block";
      }
    }
  }
  else{
    for(i=0;i<els.length;i++){
      els[i].style.display="inline-block";
    }
  }
}

// ondragover must be handled like that to make ondrop work
tube.ondragover = function(e){
  e.preventDefault();
  e.dataTransfer.dropEffect = 'copy';
  return false;
}

// ondrop
tube.ondrop = function(e){
  e.stopPropagation();
  tube.innerHTML = top[e.dataTransfer.getData('Text')].outerHTML + tube.innerHTML;
  search.value = "";
  search.onkeyup();
  
  // 1 element dropped
  if(tube.children.length == 1){
    setTimeout('tube.className = "x1"', 10);
  }
  
  // 2 elements dropped
  if(tube.children.length == 2){
  
    tube.className = "x2";
    ok = 0;
    
    // Check the mix of the two
    for(i = 0; i < mix.length; i += 4){
      if(
        ((mix[i + 1] == tube.children[0].id && mix[i + 2] == tube.children[1].id)
        ||
        (mix[i + 1] == tube.children[1].id && mix[i + 2] == tube.children[0].id))
        &&
        top[mix[i]] === undefined
      )
      {
        setTimeout('tube.className += " mix"');
        setTimeout(function(){
          tube.className = "mixed";
          tube.innerHTML = "";
          elements.innerHTML += "<a class='combined mix' id=" + mix[i] + " draggable=true href=javascript:; ondragstart=\"event.dataTransfer.effectAllowed='copy';event.dataTransfer.setData('Text',this.id)\" title='" + mix[i+1] + " + " + mix[i+2] + "'><h1>" + mix[i + 3] + "</h1><p>" + mix[i].replace(/([a-z])([A-Z])/g, "$1 $2") + "</p></a>";
          setTimeout('top[mix[i]].className="combined";', 200);
          setTimeout('top[mix[i]].className="end";', 800);
        },500);
        ok = 1;
        
        // Enable save
        save.className = '';
        
        // Disable load
        load.className = 'hidden';
        
        score.innerHTML = +score.innerHTML + 1;
        
        // Enable menu
        if(+score.innerHTML == 1){
          setTimeout("dialog_save.className = 'visible';",2000);
        }
        
        // Enable hints
        if(+score.innerHTML == 10){
          setTimeout("dialog_hint.className = 'visible'",2000);
        }
        
        // Enable human
        if(+score.innerHTML == 30){
          setTimeout("dialog_human.className = 'visible'",2000);
        }
        break;
      }
    }
    
    // No combination found
    if(!ok){
      setTimeout('tube.className += " nomix";', 200);
      setTimeout('tube.className += " poof";', 800);
      setTimeout('tube.className = ""; tube.innerHTML = "";', 1300);
    }
  }
  
  search.focus();
}

// Hint
show_hint = function(){
  while(1){
    rand = Math.ceil(Math.random() * mix.length) * 4;
    if(top[mix[rand + 1]] && top[mix[rand + 2]] && !top[mix[rand]]){
      return "Try to make " + mix[rand].replace(/([a-z])([A-Z])/g, "$1 $2") + "... New hint?";
    }
  }
}

// Combinations
mix =
[

// Generation 1 (combinations of primary elements)
"Dust","Earth","Air","â‹¯", // ok
"Lava","Fire","Earth","~ğŸ”¥~", // ok
"Mud","Water","Earth","~ğŸ·~", // ok
"Pressure","Earth","Earth","--|  |--", // ok
"Sea","Water","Water","ê•€", // ok
"Rain","Water","Air","â˜”", // ok
"Steam","Water","Fire","â˜", // ok
"Energy","Air","Fire","Ò‰", // ok

// Generation 2 (combinations of elements of previous generations)
"Gunpowder","Fire","Dust","â‹¯ğŸ”«", // ok
"Stone","Water","Lava","â", "Stone","Sea","Lava","â", "Stone","Ocean","Lava","â", // ok
"Volcano","Earth","Lava","ğŸŒ‹", // ok
"Brick","Fire","Mud","â–­", "Brick","Air","Mud","â–­", // ok
"Wind","Air","Pressure","ğŸƒ", // ok
"Ocean","Sea","Sea","ê•€ê•€<br>ê•€", // ok
"Flood","Rain","Rain","~â˜”~", // ok
"Cloud","Air","Steam","â˜â˜â˜", // ok
"Earthquake","Energy","Earth","(( ğŸ˜¨ ))", // ok
"Alcohol","Water","Energy","ğŸº", // ok
"Plant","Rain","Earth","ğŸŒ±", // ok
"Geyser","Earth","Steam","ê–‚",// bof

// Generation 3
"Storm","Energy","Cloud","â˜â˜â˜<br>âš¡", // ok
"Explosion","Fire","Gunpowder","ğŸ’¥", // ok
"Eruption","Energy","Volcano","â˜ğŸŒ‹â˜", "Eruption","Lava","Volcano","â˜ğŸŒ‹â˜", "Eruption","Fire","Volcano","â˜ğŸŒ‹â˜", // ok
"Isle","Volcano","Ocean","ğŸŒ´", // ok
"Wall","Brick","Brick","â–­â–­â–­<br><br>â–­â–­", // ok
"Hurricane","Energy","Wind","ğŸŒ€","Hurricane","Wind","Wind","ğŸŒ€",// ok
"Wave","Wind","Sea","ğŸŒŠ","Wave","Wind","Water","ğŸŒŠ","Wave","Wind","Ocean","ğŸŒŠ",// ok
"Tsunami","Earthquake","Ocean","ğŸŒŠğŸ˜“ğŸŒŠ",// ok
"Sky","Cloud","Air","â˜€â˜","Sky","Cloud","Sun","â˜€â˜",// ok
"Fog","Cloud","Earth","ß‰â˜ &nbsp;ğŒ’",// ok
"Mountain","Earthquake","Earth","â—­â—­",// ok
"Metal","Fire","Stone","âš“",// ok
"Sand","Air","Stone","â‹¯â–³â‹¯","Sand","Sea","Stone","â‹¯â–³â‹¯","Sand","Ocean","Stone","â‹¯â–³â‹¯","Sand","Water","Stone","â‹¯â–³â‹¯",// ok
"Vodka","Water","Alcohol","ğŸ¶",// bof
"Swamp","Mud","Plant","Ë‡ &nbsp; Ë‡<br>ê•€ê•€ê•€",// ok
"Algae","Water","Plant","ê•€ğŸŒ¿ê•€","Algae","Sea","Plant","ê•€ğŸŒ¿ê•€","Algae","Ocean","Plant","ê•€ğŸŒ¿ê•€",// ok
"Coal","Plant","Pressure","âš«",// ok
"Cotton","Cloud","Plant","âš˜",// ok
"Moss","Plant","Stone","à·´",// ok

// Generation 4
"Horizon","Sky","Ocean","â˜€<br><br>ê•€ê•€ê•€",// ok
"AtomicBomb","Energy","Explosion","ğŸ’£",// ok
"Fireworks","Sky","Explosion","ğŸ†",// ok
"Archipelago","Isle","Isle","ğŸŒ´ğŸŒ´ğŸŒ´",// ok
"Sound","Wave","Air","â™«",// ok
"Sun","Fire","Sky","â˜€",// ok
"River","Water","Mountain","â—­ğŸŒŠâ—­",// ok
"Blade","Stone","Metal","âš”",// ok
"Sandstone","Sand","Stone","â‹¯ââ‹¯",// ok
"Boiler","Metal","Steam","â",// ok
"Bullet","Gunpowder","Metal","â‰¡ â«",// ok
"Electricity","Energy","Metal","âŒğŸ”Œ",// ok
"Quicksilver","Water","Metal","â˜¿",// ok
"Beach","Water","Sand","ğŸŒŠğŸŒ´",// ok
"Desert","Sand","Sand","â‹¯á±á±â‹¯",// ok
"Cactus","Plant","Sand","ğŸŒµ",// ok
"Clay","Sand","Swamp","ğŸ¯", "Clay","Mud","Sand","ğŸ¯",// ok
"Life","Energy","Swamp","â™¥",// ok
"Diamond","Coal","Pressure","â—‡",// ok
"Grass","Earth","Moss","à·´","Grass","Earth","Plant","à·´à·´",// ok
"Fern","Moss","Swamp","ğŸŒ¿",// ok

// Generation 5
"Oxygen","Sun","Plant","âš›",// ok
"Salt","Sun","Ocean","Ï´", "Salt","Sun","Sea","Ï´",// ok
"Gun","Metal","Bullet","<div style='text-align:left;margin:-20px 0 0 20px'>,____,<br><br><br>//'<br>~</div>",// ok
"Sword","Metal","Blade","âš”",// ok
"Pottery","Fire","Clay","ğŸ¯",// ok
"Oasis","Water","Desert","â‹¯ğŸŒ´â‹¯",// ok
"Pyramid","Desert","Stone","â‹¯â—®â‹¯",// ok
"Flower","Sun","Grass","â€", "Flower","Plant","Garden","â€",// ok
"Scythe","Blade","Grass","ãƒ¬",// ok
"Dew","Grass","Fog","Òˆ",// ok
"Ring","Diamond","Metal","â—",// ok
"Tobacco","Fire","Plant","ğŸš¬",// ok
"RadioWave","Electricity","Air","(( ğŸ“» ))", //ok

// Generation 6
"Glass","Electricity","Sand","ğŸ·", "Glass","Fire","Sand","ğŸ·",// ok
"Lightsaber","Energy","Sword","<span style=font-size:17px>â•£=========","Lightsaber","Light","Sword","<span style=font-size:17px>â•£=========",// ok
"Hay","Scythe","Grass","â &nbsp; ğŸ‘",// ok
"Garden","Flower","Flower","ğŸŒ» ğŸ’®<br><br>ğŸŒº","Garden","Flower","Grass","ğŸŒ» ğŸ’®<br><br>ğŸŒº","Garden","Plant","Grass","ğŸŒ» ğŸ’®<br><br>ğŸŒº",// ok
"Sunflower","Sun","Flower","ğŸŒ»",// ok

// Generation 7
"Scissors","Blade","Blade","âœ‚",// ok
"LightBulb","Electricity","Glass","ğŸ’¡",// ok
"MagnifyingGlass","Metal","Glass","ğŸ”",// ok
"Time","Sand","Glass","â´µ",
"Eyeglasses","Glass","Glass","ğŸ‘“",// ok
"Aquarium","Water","Glass","( &nbsp; ğŸŸ &nbsp; )<br>___",// ok
"Ice","Glass","Water","â’<br><br>â’â’","Ice","Water","Cold","â’<br><br>â’â’",// ok
"Needle","Hay","Metal","~ &nbsp; &nbsp; &nbsp; &nbsp; <br>â•¿",// ok
"Oil","Sunflower","Pressure","à®ƒ", "Oil","Coal","Water","à®ƒ",// ok

// Generation 8
"Napalm","Fire","Oil","â˜ğŸ’¥â˜",// ok
"Light","Electricity","LightBulb","âª«ğŸ’¡âªª",// ok
"Sunglasses","Sun","Glass","ğŸ˜","Sunglasses","Sun","Eyeglasses","ğŸ˜",// ok
"Lamp","LightBulb","Metal","<div style=margin-top:-35px>__<br><br><br>/___\\<br><br><br>(_)",// ok
"Hail","Cloud","Ice","<div style=margin-top:-10px>| |<br><br><br>ß‹",// ok
"Iceberg","Sea","Ice","~â§~","Iceberg","Ocean","Ice","~â§~",// ok
"Clock","Electricity","Time","â°",// ok

// Generation Human + 1
"Blood","Human","Blade","?",
"CarbonDioxide","Human","Air","?",
"Cold","Rain","Human","?","Sickness","Rain","Human","?", // DISAMBIGUATE
"Corpse","Fire","Human","?","Corpse","Human","Gun","?",
"Drunk","Human","Alcohol","?",
"Electrician","Electricity","Human","?",
"Tools","Metal","Human","?",
"Fireman","Fire","Human","?",
"House","Brick","Human","?",
"Hut","Stone","Human","?",
"Idea","Light Bulb","Human","?",
"Jedi","Lightsaber","Human","?",
"Love","Human","Human","?","Sex","Human","Human","?",//DISAMBIGUATE
"Music","Sound","Human","?",
"Nerd","Glasses","Human","?",
"Scarecrow","Human","Hay","?",
"Surfer","Wave","Human","?",
"Warrior","Sword","Human","?",
"Watch","Human","Clock","?",
"Wizard","Energy","Human","?",
"Death","Human","Life","",

// Generation Human + 2
"Engineer","Human","tools","?",
"Shark","Blood","Ocean","?",
"Vampire","Blood","Human","?",
"Fridge","Metal","Cold","?",
"Snow","Rain","Cold","?",
"Frankenstein","Electricity","Corpse","?",
"Grave","Earth","Corpse","?",
"Mummy","Pyramid","Corpse","?",
"Skeleton","Time","Corpse","?","Bone","Time","Corpse","?",//DISAMBIGUATE
"Zombie","Life","Corpse","",
"Umbrella","Rain","tools","?",
"Computer","Nerd","tools","?",
"Field","Earth","tools","?",
"LawnMower","tools","Grass","?",
"Pitchfork","tools","Hay","?",
"Statue","Stone","tools","?",
"Thread","Cotton","tools","?",
"Family","Human","House","?",
"Igloo","Ice","House","?",
"Skyscraper","House","Glass","?","Skyscraper","Sky","House","?",
"Village","House","House","?",
"Windmill","Wind","House","?",
"Ash","Fire","House","â–²","Ash","Fire","Human","â–²","Ash","Fire","Wood","â–²",
"Rose","Love","Plant","?",
"Styx","Water","Death","",

// Generation Human + 3
"Bat","Vampire","Air","","Bat","Sky","Mouse","?",
"Avalanche","Energy","Snow","?",
"Snowball","Human","Snow","?","Snowman","Snow","Human","?",//DISAMBIGUATE
"Gravestone","Stone","Grave","?",
"Graveyard","Grave","Grave","?",
"Internet","Computer","Computer","?",
"AI","Computer","Life","",
"Cyborg","Computer","Human","?",
"Farmer","Human","Field","?",
"Fountain","Statue","Water","?",
"Fabric","Thread","tools","?",
"City","Village","Village","?",
"WindTurbine","Windmill","Electricity","?",

// Generation Human + 4
"Batman","Bat","Human","?",
"Cyberspace","Internet","Life","",
"Farm","Farmer","House","?","Farm","Farmer","Barn","?",
"Clothes","Fabric","Human","?",
"Wire","Electricity","Metal","?",

// Generation Human + 5
"Livestock","Life","Farmer","?",
"Dynamite","Wire","Gunpowder","?",

// Generation Human + 6
"Goat","Livestock","Mountain","?",
"Horse","Hay","Livestock","?",
"Pig","Mud","Livestock","?",
"Sheep","Cloud","Livestock","?",
"Barn","House","Livestock","?",
"Cow","Livestock","Grass","?",

// Generation Human + 7
"Faun","Human","Goat","?",
"Hippo","Horse","River","?",
"Seahorse","Horse","Ocean","?",
"Centaur","Human","Horse","?",
"Bacon","Fire","Pig","?",
"Wool","Sheep","tools","?",
"Leather","Blade","Cow","?",
"Manatee","Cow","Sea","?",
"Meat","tools","Cow","?",
"Milk","Farmer","Cow","?",
"Minotaur","Cow","Human","?",

// Generation Human + 8
"Sweater","Wool","tools","?","Fabric","Tools","Wool","?",//DISAMBIGUATE
"Saddle","Horse","Leather","?",
"Ham","Meat","Smoke","?",
"Steak","Fire","Meat","?",
"Butcher","Human","Meat","?",
"Butter","Milk","Pressure","?",
"Cheese","Time","Milk","?",
"IceCream","Cold","Milk","?","IceCream","Ice","Milk","?",

// Generation Human + 9
"Moon","Sky","Cheese","?",
"MilkShake","Milk","IceCream","?",

// Generation Human + 10
"Night","Time","Moon","?",
"Tide","Moon","Sea","?",
"Astronaut","Human","Moon","?",
"Eclipse","Sun","Moon","?",

// Generation Human + 11
"Star","Night","Sky","?",
"Twilight","Day","Night","?",
"Ghost","Graveyard","Night","?",

// Generation Human + 12
"BlackHole","Star","Pressure","?",
"Constellation","Star","Star","?","Galaxy","Star","Star","?",//DISAMBIGUATE
"Shuriken","Star","Blade","?",
"Space","Star","Sky","?",

// Generation Human + 13
"Ninja","Human","Shuriken","?",
"Planet","Earth","Space","?",
"Void","Space","Space","?",
"Meteoroid","Stone","Space","?",
"MilkyWay","Milk","Space","?",

// Generation Human + 14
"SolarSystem","Sun","Planet","?",
"Alien","Life","Void","?","Alien","Space","Life","?",
"Lightbulb","Void","Glass","?",
"Radiowave","Void","Electricity","?",

// Generation Human + 15
"TV","Lightbulb","Radiowave","?",
"Radar","Air","Radiowave","",

]

</script>